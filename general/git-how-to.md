## Шпаргалка по Git

Начать рассказ о git-е лучше всего с пространственных размышлений о том, что это вообще такое. Git - это система 
контроля версий, которая:
- Спасет вас при поломке компьютера (ваши лабы останутся в удаленном хранилище)
- Поможет при работе в парах (нет необходимости собираться за одним компьютером)
- Предоставит вам возможность лаконично, в виде одной ссылки, показать преподавателю код

Необходимо различать понятие системы контроля версий и конкретных реализаций удаленных хранилищ. Система 
контроля версий - git, svn, mercurial. Удаленные хранилища - GitHub, GitLab, Bitbucket. Каждое удаленное хранилище 
использует свою технологию для реализации "контроля версий". В случае упомянутых трех - git. Для студентов 
использование GitHub-а, GitLab-а и BitBucket-а абсолютно бесплатное, однако присутствуют ряд ограничений, с которыми 
стоит ознакомиться отдельно.

Многие IDE и другие средства разработки предоставляют графический интерфейс для работы с гитом. Автор этой заметки 
**настоятельно рекомендует** овладеть консольными командами git. Они позволяют многие вещи делать намного быстрее и 
удобнее, также использование терминало вместо GUI экономит ресурсы вашего компьютера.

### Как установить Git?

[читать тут](https://git-scm.com/book/ru/v2/%D0%92%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-Git)

### Как работает Git?

Разговор о гите всегда затрагивает эти понятия: удаленный репозиторий, локальный репозиторий, ветка, коммит. 

Первые два означают одно и то же, однако в первом случае репозиторий (хранилище) находится где-то в этих ваших интернетах, 
а во втором - локально на вашем компьютере. 

Коммит - зафиксированная единица изменений в вашем проекте. Например, вы изменили строчку `System.out.println()` на 
`System.out.printf("О БОЖЕ, Я НИЧЕГО НЕ ПОНИМАЮ")` - это изменение. Когда вы выполняете команду "коммит" - вы 
фиксируете изменения в **локальном** репозитории. Еще раз подчеркну, в локальном репозитории, это важно помнить. 
Пока вы не "запушити" ваши коммиты в удаленный репозиторий, они, очевидно, туда не попадут.

Ветка - под веткой понимают последовательность (необязательно хронологическую) коммитов, каждый из которых обладает: 
автором коммита, сообщением коммита и хешом коммита. Хеш коммита - его уникальный идентификатор. У веток бывают имена, 
самые популярные из которых - master и dev. Ветка "master" имеет особое значение - это основная, корневая ветка 
вашего проекта. Без ветки master не может существовать ни один репозиторий, ее ни в коем случае не стоит удалять.

В самом простом случае, вы имеете репозиторий всего с одной веткой "master". В таком случае, ваша работа с репозиторием 
предельно проста: фиксировать изменения, пушить их в удаленное хранилищи. Вам требуется уметь делать только эти две 
операции. Далее в данном тексте мы будем рассматривать именно такой случай.

### Как создать локальный репозиторий?

Для этого вам требуется в любой директории (как будет понятно далее, она необязана быть пустой) на вашем компьютере 
выполнить следующую команду:
```bash
git init
```

После чего гит создаст в этой директории специальную скрытую директорию `.git`, где гит хранит служебную информацию. 
Если удалить эту директорию - будет удален локальный репозиторий без возможности восстановления.

### Как создать удаленный репозиторий?

1. Зайти в свой аккаунт в любом удаленном хранилище
2. Создать там **пустой** репозиторий. Внимание, ПУСТОЙ здесь написано непросто так
3. Получить https ссылку на ваш репозиторий
4. Открыть терминал и перейти в директорию с **уже созданным** локальным репозиторием
5. Последовательно выполнить команды (команды `git config` опциональны - они позволяют перекрыть глобальные настройки 
гита и указать конкретные user email и user name, которые будут использоваться для создания коммитов в данном проекте):
```bash
git remote add origin ЗДЕСЬ_ВСТАВИТЬ_ССЫЛКУ_ПОЛУЧЕННУЮ_НА_ШАГЕ_3
git config --local user.email "тут ваш email"
git config --local user.name "тут ваш никнейм"
```
6. На этом шаге нужно создать любой файл\файлы\директории. Если директория проекта уже содержит файлы, можно ничего 
не создавать
7. Выполнить последовательно команды:
```bash
git add .
git commit -m "Initial commit"
git push origin master
```
8. Поздравляю, ваш удаленный репозиторий проинициализирован. Теперь можно использовать его в "обычном режиме"

### "Обычный режим" работы с гитом

Здесь подразумевается, что вы уже успешно создали локальный и удаленный репозитории.

Стандартный workflow работы с гитом выглядит так: вы пишите какой-то код, что-то меняете, после чего понимаете, что 
настало время зафиксировать изменения. Вы выполняете последовательно следующие команды:
```bash
git add .
git commit -m "НЕПУСТОЕ СООБЩЕНИЕ КОММИТА"
```

Командами выше вы выполнили следующие действия:
- "Поместили" ваши изменения в stage область (в коммит будут включены только те изменения, которые включены в stage)
- Создали коммит из всех изменений в stage области и разместили его в текущей ветке в локальном репозитории

Если вы понимаете, что вам необходимо отправить коммиты из локального репозитория в удаленный, вам необходимо также 
выполнить команду:
```bash
git push origin master
```

### .gitignore

В репозитории можно создать специальный файл `.gitignore` (по умолчанию скрытый), в котором можно описать файлы и 
директории, которые будут игнорироваться в вашем репозитории. Лучше всего создавать этот файл в момент создания 
"initial" коммита. В противном случае нежелательные файлы придется удалить из репозитория, в том числе удаленного.
В `.gitignore` описываются пути к файлам и директориям, которые требуется игнорировать. Пути отсчитываются от положения 
`.gitignore` файла (автор заметки рекомендует всегда располагать его в корне проекта).

Пример, для Java-проекта под управлением системы сборки Gradle, разрабатываемый в IntellijIDEA:
```text
/.idea/
/build/
/out/
/.gradle/
*.iml
```

В примере игнорируются: 
- `.idea` - служебные файлы IntellijIDEA (их ни в коем случае ненужно хранить в 
репозитории - можно поломать настройки IDEA товарища по лабе) 
- `.gradle` - кеш Gradle-а
- `*.iml` - служебные файлы IntellijIDEA (обычно генерируются, если собрать проект без системы сборки) 
- `build` - стандартная директория, где Gradle хранит сборки и байт-код
- `out` - стандартная директория, где IntellijIDEA хранит сборки и байт-код.

### Описание консольных команд Git

Базовые команды:
- `git init` - инициализировать пустой локальный репозиторий
- `git remote add origin URL_HERE` - добавить ссылку на удаленный репозиторий в качестве источника "origin"
- `git add .` - добавить все изменения в проекте в stage область
- `git commit -m "НЕПУСТОЕ СООБЩЕНИЕ КОММИТА"` - создать коммит с указанным сообщением из всех изменений в stage области
- `git push origin master` - отправить все изменения из текущей ветки в удаленный репозиторий по источнику "origin" в
удаленную ветку "master"

Еще больше базовых команд:
- `git restore --staged .` - убрать все изменения из stage области
- `git restore .` - отменить все незафиксированные измененияя
- `git checkout BRANCH_NAME_HERE` - изменить текущую ветку
- `git checkout -b NEW_BRANCH_NAME_HERE` - создать новую ветку на данной позиции
- `git branch` - посмотреть доступные ветки (локальные ветки)
- `git branch -D BRANCH_NAME_TO_DELETE_HERER` - удалить локальную ветку
- `git log --graph` - посмотреть историю коммитов в виде графа
- `git log` - посмотреть историю коммитов
- `git fetch` - опросить удаленный репозиторий об изменениях
- `git pull origin master` - скачать изменения из удаленного репозитория по источнику "origin" из ветки "master" в 
текущую ветку
- `git merge BRANCH_NAME_HERE` - смержить ветку с указанным именем в текущую

Продвинутые команды:
- `git rebase -i BRANCH_NAME_HERE` - выполнить ребейз текущей ветки на указанную в интерактивном режиме
- `git cherry-pick COMMIT_HASH_HERE` - выполнить черри-пик указанного коммита на вершину текущей ветки
- `git reset HEAD~1` - отменить верхний коммит из локальной ветки, изменения коммита вернуть в непроиндексированную 
область
- `git revert COMMIT_HASH_HERE` - откатить изменения выбранного коммита (изменения из коммита будут сброшены в отличие 
от `git reset`)
- `git stash` - поместить изменения из stage области в область временных изменений (stash область)
- `git stash pop` - вынуть последние изменения из stash области и применить их, поместить в stage область, удалить эту 
"порцию" изменений из stash области